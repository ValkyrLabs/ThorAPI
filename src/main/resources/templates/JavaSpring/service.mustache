/** THORAPI
 * {@link {{classname}}}}.
 *
 *
 {{#description}}{{.}}{{/description}}{{^description}}{{classname}}{{/description}}
 ############################## DO NOT EDIT: GENERATED FILE ##############################

    Generated by Valkyr Labs ThorAPI: https://valkyrlabs.com/thorapi
    Powered by Swagger Codegen: http://swagger.io
    
    Template file: JavaSpring/service.mustache

############################## DO NOT EDIT: GENERATED FILE ##############################
 #
 * Do not edit the class manually.
 */
package {{package}};

import {{apiPackage}}.*;
import java.util.Optional;
import java.util.List;
import java.util.UUID;
import {{javaxPackage}}.validation.constraints.*;
import {{javaxPackage}}.validation.Valid;
{{#imports}}import {{import}};
{{/imports}}

import org.springframework.security.acls.domain.GrantedAuthoritySid;
import org.springframework.security.acls.domain.ObjectIdentityImpl;
import org.springframework.security.acls.model.MutableAcl;
import org.springframework.security.acls.model.MutableAclService;
import org.springframework.security.acls.model.ObjectIdentity;
import org.springframework.security.acls.model.Sid;


import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.domain.Example;

import org.springframework.transaction.annotation.Transactional;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.security.access.prepost.PostFilter;

/** 
*
*  ThorAPI Service Methods
*
*/
@Service
// @Validated
// @Transactional(readOnly = false)
public class {{classname}}Service {

    @Autowired
    private {{classname}}Repository {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository;

    @Autowired
    private MutableAclService aclService;

    @Autowired
    private {{classname}}PageableRepository {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}PageableRepositoryRepository;

   // @PostFilter("hasPermission(filterObject, 'read') or hasRole('ADMIN')")
    public Page<{{modelPackage}}.{{classname}}> findAll(Pageable pageable){
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}PageableRepositoryRepository.findAll(pageable);
    }

    // @PostFilter("hasPermission(filterObject, 'read') or hasRole('ADMIN')")
    public Page<{{modelPackage}}.{{classname}}> findAll(Example<{{modelPackage}}.{{classname}}> example, Pageable pageable){
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}PageableRepositoryRepository.findAll(example, pageable);
    }

    public {{classname}}Repository getRepository(){
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository;
    }

// TODO: testing only    @PreAuthorize("(#{{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}} != null && hasPermission(#{{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}.id, 'write')) or hasRole('ADMIN')")
    public {{modelPackage}}.{{classname}} insert({{modelPackage}}.{{classname}} {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}) {
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository.save({{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}});
    }

    //@PreAuthorize("(#{{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}} != null && hasPermission(#{{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}.id, 'write')) or hasRole('ADMIN')")
    public {{modelPackage}}.{{classname}} saveOrUpdate( {{#useBeanValidation}}
                {{>beanValidation}}
            {{/useBeanValidation}} {{modelPackage}}.{{classname}} {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}) {
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository.save({{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}});
    }

    //@PreAuthorize("hasPermission(#id, 'read') or hasRole('ADMIN')")
    public Optional<{{modelPackage}}.{{classname}}> findById(UUID id) {
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository.findById(id);
    }

    //@PostFilter("hasPermission(filterObject, 'read') or hasRole('ADMIN')")
    public List<{{modelPackage}}.{{classname}}> findAll() {
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository.findAll();
    }

    {{#models}}
    {{#model}}
    {{#allVars}}
    {{^deprecated}}
   // @PostFilter("hasPermission(filterObject, 'read') or hasRole('ADMIN')")
    public List<{{modelPackage}}.{{classname}}> find{{#lambda.titlecase}}{{classname}}{{/lambda.titlecase}}By{{#lambda.pascalcase}}{{name}}{{/lambda.pascalcase}}({{#isEnum}}{{modelPackage}}.{{classname}}.{{datatypeWithEnum}}{{/isEnum}}{{^isEnum}}{{{dataType}}}{{/isEnum}} {{name}}){
        return {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository.find{{classname}}By{{#lambda.pascalcase}}{{name}}{{/lambda.pascalcase}}({{name}});
    }
    {{/deprecated}}
    {{/allVars}}
    {{/model}}
    {{/models}}

    //@PreAuthorize("hasPermission(#id, 'delete') or hasRole('ADMIN')")
    public void deleteById(UUID id) {
        {{#lambda.lowercase}}{{classname}}{{/lambda.lowercase}}Repository.deleteById(id);
    }


}
