# âš¡ï¸ ThorAPI â€” Deterministic Code Generation for Sovereign Systems



# ThorAPI â€” Badges & Logos (Copy/Paste)

> Drop these right under the `# ThorAPI` heading in your README. All are Shields.io badges using official logos where available.

---

## ğŸ§° Core Project Badges

[![Build](https://img.shields.io/github/actions/workflow/status/valkyrlabs/thorapi/ci.yml?branch=main&label=Build&logo=githubactions)](https://github.com/valkyrlabs/thorapi/actions)
[![Release](https://img.shields.io/github/v/release/valkyrlabs/thorapi?display_name=release&logo=semanticrelease&label=Release)](https://github.com/valkyrlabs/thorapi/releases)
[![License](https://img.shields.io/badge/license-Apache--2.0-blue?logo=apache)](https://www.apache.org/licenses/LICENSE-2.0)
[![Generated Code License](https://img.shields.io/badge/generated%20code-MIT-green?logo=open-source-initiative)](./LICENSE)
[![Conventional Commits](https://img.shields.io/badge/commits-conventional-ff69b4?logo=conventionalcommits)](https://www.conventionalcommits.org/en/v1.0.0/)

ThorAPI turns OpenAPI specs into secure, production-ready backend services and client SDKs.
Itâ€™s the open-source backbone of Valkyr Labsâ€™ â€œReverse SaaSâ€ architecture â€” where developers own the code, the data, and the keys.

â¸»

## ğŸ§­ Overview

ThorAPI is a spec-driven code generator that transforms OpenAPI YAML definitions into:
â€¢ Java Spring Boot microservices with RBAC, JWT, ACL, and SecureField integration.
â€¢ TypeScript/React client SDKs generated via Swagger templates.
â€¢ Optional React-Native frontends (coming soon).
â€¢ Auto-wired ValkyrAI workflow JSONs for end-to-end agentic orchestration.

Itâ€™s built for determinism, auditability, and sovereignty â€” every line of code it emits is reproducible from a known spec and template revision.

â¸»

## ğŸ—ï¸ Architecture

```
OpenAPI Spec â†’ ThorAPI Core â†’ Templates â†’ Generated Backend / SDK / Workflow
â†‘ â”‚ â”‚ â†“
Bundles/Specs â†’ Assembler â†’ Enhancer â†’ api-out.yaml + Generated Code
```

Core Concepts
â€¢ Spec-First: Define your API in openapi/api.yaml.
â€¢ Bundle Assembly: Merge reusable schema bundles and object models dynamically.
â€¢ Enhancement: Apply intelligent type inference, encryption directives, ACL injection, and more.
â€¢ CodeGen: Generate Spring Boot + TypeScript SDKs using deterministic templates.

â¸»

## ğŸ§© Bundle Assembly Workflow

ThorAPI supports assembling modular bundles (schemas, paths, components) before generation.

1. src/main/resources/openapi/api.yaml is read-only â€” it defines your REST surface.
2. A bundles/ directory beside it contains fragment specs (e.g., user.yaml, invoice.yaml, etc.).
3. During build, ThorAPI merges the bundles into a temporary thorapi-assembled-<uuid>.yaml.
4. Enhancements are applied, producing the final api-out.yaml.
5. Only the enhanced output is written back to disk â€” the temp file is transient and deleted on JVM exit.

Enable Assembly

export THORAPI_ENABLE_BUNDLES=true

or

```bash
mvn spring-boot:run -Dthorapi.enableBundles=true
```

## or programmatically:

```bash
ThorAPI.setBundleAssemblyOverride(true);
```

ThorAPIController enables this automatically during generation requests.

â¸»

## ğŸ” Security by Design

ThorAPI enforces field-level security and auditable access control out of the box.

Feature Description
SecureField Annotations Built-in encryption for PII/PHI/PCI fields, integrated with SecureField KMS.
RBAC + ACLs Compatible with ValkyrAIPermissionEvaluator and Spring Security @EnableMethodSecurity.
JWT Auth Generated endpoints include login, token refresh, and tenant isolation.
Audit Logging Automatic WebSocket event streams for runtime traceability.

â¸»

## âš™ï¸ Example Usage

git clone https://github.com/valkyrlabs/thorapi.git
cd thorapi
mvn clean install

Place your OpenAPI spec in:

src/main/resources/openapi/api.yaml

Then run:

java -jar target/thorapi.jar generate

Outputs:
â€¢ api-out.yaml (enhanced spec)
â€¢ /generated/ Spring Boot backend
â€¢ /generated-sdk/ TypeScript client
â€¢ Optional /workflow/ ValkyrAI JSON

â¸»

## ğŸš€ Quick Start (Docker)

docker run -it --rm \
 -v $(pwd)/my-specs:/app/specs \
 -v $(pwd)/output:/app/output \
 valkyrlabs/thorapi:latest

â¸»

## ğŸ§  Integration with the Valhalla Suite

Component Role

- ValkyrAI Executes workflows generated by ThorAPI (OpenAPI â†’ AI orchestration).
- SecureField KMS Provides encryption and key management for generated fields.
- ValorIDE Automates PRD execution and project generation via ThorAPI CLI or API.
- GridHeim Offers spreadsheet-native models for dynamic data and formulas.

ThorAPI is open source (ALv2); enterprise security and hosted orchestration layers are part of ValkyrAI Commercial.

â¸»

ğŸ§ª Example: Generating a Secure API

```yaml
# openapi/api.yaml
components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
          x-securefield: encrypt
paths:
  /users:
    get:
      summary: List users
      responses:
        "200":
          description: OK
```

Run ThorAPI:

java -jar thorapi.jar generate

Generated Spring Boot model:

@SecureField
private String email;

â¸»

ğŸ”§ Configuration

Property Default Description
thorapi.enableBundles false Enables bundle assembly
thorapi.outputDir ./generated Destination for generated code
thorapi.specPath ./src/main/resources/openapi/api.yaml Path to input spec
thorapi.templateDir embedded Template set for codegen
thorapi.enhancers DefaultEnhancer Custom enhancement chain

â¸»

ğŸ’¡ Developer Notes
â€¢ Built with Java 21, Spring Boot 3.x, and Swagger Codegen.
â€¢ Compatible with Maven Central io.valkyr:thorapi-core.
â€¢ Use alongside ValkyrAI CLI for automated code-to-workflow generation.

â¸»

ğŸ›¡ï¸ License
â€¢ Core engine and templates are Apache License 2.0.
â€¢ Generated code is MIT Licensed (you own what you generate).
â€¢ Advanced key management and workflow integration available under ValkyrAI Commercial License.

â¸»

ğŸŒ Community & Support
â€¢ ğŸ“š Docs: https://valkyrlabs.com/docs/thorapi
â€¢ ğŸ’¬ Discussions: https://github.com/valkyrlabs/thorapi/issues
â€¢ ğŸ§° Join the Reverse SaaS Builders movement at https://valkyrlabs.com
â€¢ ğŸ§™â€â™‚ï¸ Built by John McMahon and the Valkyr Labs Collective

â¸»

ThorAPI â€” because real power is owning the forge that builds your systems.
